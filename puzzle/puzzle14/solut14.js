function init(){window.onerror=Fehlerbehandlung(),canvas1=document.getElementById("myCanvas"),ctx=canvas1.getContext("2d"),doClear()}function doClear(){for(var r=0;12>r;r++)for(var e=0;12>e;e++)board[r][e]=-1;for(r=1;11>r;r++)for(e=1;11>e;e++)board[r][e]=0;for(board[1][1]=-1,board[1][10]=-1,board[10][1]=-1,board[10][10]=-1,board[2][2]=-1,board[2][9]=-1,board[9][2]=-1,board[9][9]=-1,board[2][1]=4,board[1][5]=9,board[3][7]=1,board[4][4]=10,board[4][8]=11,board[5][4]=2,board[5][6]=5,board[6][2]=2,board[6][8]=1,board[7][6]=3,board[8][2]=7,board[8][3]=6,board[8][9]=8,zugnr=0,message.innerHTML="Zugnummer: "+zugnr,r=0;8>r;r++)farbe[r]="blue";farbe[3]="red",farbe[4]="red",document.getElementById("Zug-").disabled=!0,document.getElementById("Zug+").disabled=!1,zeichne()}function zeichne(){ctx.clearRect(0,0,W,H),ctx.beginPath(),ctx.strokeStyle="black",ctx.lineWidth="1";for(var r=0;13>r;r++){var e=r*sw;ctx.moveTo(e,0),ctx.lineTo(e,H)}for(r=0;13>r;r++){var a=r*sh;ctx.moveTo(0,a),ctx.lineTo(W,a)}for(ctx.stroke(),ctx.closePath(),r=1;13>r;r++){e=(r-1)*sw;for(var t=1;13>t;t++){a=(t-1)*sh;var n=board[t-1][r-1];ctx.beginPath(),-1==n&&(ctx.fillStyle="gray"),0==n&&(ctx.fillStyle="white"),1==n&&(ctx.fillStyle="red"),2==n&&(ctx.fillStyle="yellow"),3==n&&(ctx.fillStyle="blue"),ctx.rect(e+1,a+1,sw-1,sh-1),ctx.fill(),n>3&&12>n&&putSquare(n,r,t,farbe[n-4]),ctx.closePath()}}}function putSquare(r,e,a,t){var n=(e-1)*sw,o=(a-1)*sh;ctx.beginPath(),ctx.fillStyle="white",ctx.rect(n+1,o+1,sw-1,sh-1),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.strokeStyle=t,ctx.rect(n+1,o+1,sw-1,sh-1),ctx.stroke(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=t,(7==r||8==r)&&(ctx.moveTo(n+3,o+sh-3),ctx.lineTo(n+sw-3,o+sh-3),ctx.lineTo(n+sw/2,o+3),ctx.lineTo(n+3,o+sh-3)),(4==r||5==r||6==r)&&ctx.arc(n+14,o+14,10,0,2*Math.PI),(9==r||10==r||11==r)&&ctx.rect(n+5,o+5,sw-10,sh-10),ctx.fill(),ctx.closePath()}function clearSquare(r,e){var a=(r-1)*sw,t=(e-1)*sh;ctx.beginPath(),ctx.strokeStyle="black",ctx.fillStyle="white",ctx.rect(a+1,t+1,sw-1,sh-1),ctx.fill(),ctx.closePath()}function down(r,e){for(nr=board[e-1][r-1],aktnr=nr,starti=r,startj=e,startcolor=farbe[nr-4],endi=r;0==board[e][r-1];)clearSquare(r,e),board[e-1][r-1]=0,putSquare(nr,r,e+1,farbe[nr-4]),board[e][r-1]=nr,e++;endj=e,1==board[e][r-1]&&(putSquare(nr,r,e,"red"),farbe[nr-4]="red"),2==board[e][r-1]&&(putSquare(nr,r,e,"yellow"),farbe[nr-4]="yellow"),3==board[e][r-1]&&(putSquare(nr,r,e,"blue"),farbe[nr-4]="blue"),ende()}function up(r,e){for(nr=board[e-1][r-1],aktnr=nr,starti=r,startj=e,startcolor=farbe[nr-4],endi=r;0==board[e-2][r-1];)clearSquare(r,e),board[e-1][r-1]=0,putSquare(nr,r,e-1,farbe[nr-4]),board[e-2][r-1]=nr,e--;endj=e,1==board[e-2][r-1]&&(putSquare(nr,r,e,"red"),farbe[nr-4]="red"),2==board[e-2][r-1]&&(putSquare(nr,r,e,"yellow"),farbe[nr-4]="yellow"),3==board[e-2][r-1]&&(putSquare(nr,r,e,"blue"),farbe[nr-4]="blue"),ende()}function right(r,e){for(nr=board[e-1][r-1],aktnr=nr,starti=r,startj=e,startcolor=farbe[nr-4],endj=e;0==board[e-1][r];)clearSquare(r,e),board[e-1][r-1]=0,putSquare(nr,r+1,e,farbe[nr-4]),board[e-1][r]=nr,r++;endi=r,1==board[e-1][r]&&(putSquare(nr,r,e,"red"),farbe[nr-4]="red"),2==board[e-1][r]&&(putSquare(nr,r,e,"yellow"),farbe[nr-4]="yellow"),3==board[e-1][r]&&(putSquare(nr,r,e,"blue"),farbe[nr-4]="blue"),ende()}function left(r,e){for(nr=board[e-1][r-1],aktnr=nr,starti=r,startj=e,startcolor=farbe[nr-4],endj=e;0==board[e-1][r-2];)clearSquare(r,e),board[e-1][r-1]=0,putSquare(nr,r-1,e,farbe[nr-4]),board[e-1][r-2]=nr,r--;endi=r,1==board[e-1][r-2]&&(putSquare(nr,r,e,"red"),farbe[nr-4]="red"),2==board[e-1][r-2]&&(putSquare(nr,r,e,"yellow"),farbe[nr-4]="yellow"),3==board[e-1][r-2]&&(putSquare(nr,r,e,"blue"),farbe[nr-4]="blue"),ende()}function back(){document.getElementById("Zug-").disabled=!0,zugnr--,message.innerHTML="Zug "+zugnr,clearSquare(endi,endj),board[endj-1][endi-1]=0,putSquare(aktnr,starti,startj,startcolor),board[startj-1][starti-1]=aktnr,farbe[aktnr-4]=startcolor}function go(){switch(document.getElementById("Zug-").disabled=!1,24>zugnr&&zugnr++,message.innerHTML="Zug "+zugnr,zugnr){case 1:right(10,9);break;case 2:down(6,2);break;case 3:right(5,5);break;case 4:down(8,5);break;case 5:left(8,11);break;case 6:right(9,5);break;case 7:down(11,5);break;case 8:left(11,8);break;case 9:down(8,8);break;case 10:right(7,6);break;case 11:down(11,6);break;case 12:left(11,8);break;case 13:up(7,11);break;case 14:left(11,9);break;case 15:down(8,9);break;case 16:down(8,8);break;case 17:left(3,9);break;case 18:down(2,3);break;case 19:down(7,9);break;case 20:right(4,9);break;case 21:right(2,9);break;case 22:down(6,9);break;case 23:right(2,8);break;case 24:down(6,8)}}function ende(){24==zugnr&&(document.getElementById("Zug-").disabled=!0,document.getElementById("Zug+").disabled=!0)}function getMousePos(r,e){var a=r.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}function Fehlerbehandlung(){}W=336,H=W,sw=W/12,sh=sw;for(var zugnr=0,starti,startj,endi,endj,aktnr,board=new Array(12),i=0;i<board.length;++i)board[i]=new Array(12);var farbe=new Array(8),canvas1,ctx;window.onload=init;