function resizeCanvas(){var e=document.getElementById("containercanvas");e.width=e.offsetWidth,W=e.width,300>W&&(W=300),W>450&&(W=450),H=Math.round(W/2),DISC_HEIGHT=Math.round(H/15),11>DISC_HEIGHT&&(DISC_HEIGHT=11),PEG_SPACE=Math.round(W/6),deltaH=Math.round(20*H/225)+1,initmade?(resize1(),zeichne()):init()}function init(){initmade=!0,window.addEventListener("resize",function(){resizeCanvas()}),canvas1=document.getElementById("myCanvas"),resize1(),ctx=canvas1.getContext("2d"),canvas1.addEventListener("click",function(e){var t=getMousePos(canvas1,e),n=t.x;if(sourcePeg_gewaehlt){if(n>10&&W/2-2*PEG_SPACE+30>n)targetPeg=0;else if(n>W/2-30&&W/2+30>n)targetPeg=1;else{if(!(n>W/2+2*PEG_SPACE-30&&W-10>n))return;targetPeg=2}sourcePeg_gewaehlt=!1;var o=targetPeg+1;document.getElementById("message").innerHTML="auf Turm "+o,moveDisc1(sourceDisc,sourcePeg,targetPeg),document.getElementById("Anz").innerHTML=moveCount,zeichne(),ende()&&(document.getElementById("message").innerHTML=moveCount==minMoves?"Gratuliere! Ziel in minimaler Anzahl Züge erreicht!":"O.K. Die minimale Anzahl Züge zum Ziel wäre "+minMoves)}else{if(n>10&&W/2-2*PEG_SPACE+30>n)sourcePeg=0;else if(n>W/2-30&&W/2+30>n)sourcePeg=1;else{if(!(n>W/2+2*PEG_SPACE-30&&W-10>n))return;sourcePeg=2}if(pegTop[sourcePeg]<0)return document.getElementById("message").innerHTML="Turm ist leer!",void 0;var o=sourcePeg+1;document.getElementById("message").innerHTML="Scheibe von Turm "+o,sourceDisc=getTopDisc(sourcePeg),sourcePeg_gewaehlt=!0,document.getElementById("Zug+").disabled=!0}},!1),doClear()}function resize1(){canvas1.width=W,canvas1.height=H}function doClear(){moveCount=0,document.getElementById("Anz").innerHTML=moveCount,document.getElementById("Zug+").disabled=!0,discs=document.getElementById("AnzS").value,3>discs&&(discs=3),discs>10&&(discs=10),document.getElementById("AnzS").value=discs,document.getElementById("message").innerHTML="Bewegen Sie alle Scheiben auf den Turm ganz rechts.",minMoves=Math.pow(2,discs)-1,Board(discs),zeichne()}function drawBoard(){for(var e=PEG1;PEG3>=e;e++)for(var t=0;t<=getPegTop(e);t++){var n=getDisc(t,e);0!=n&&(width=Math.round(getDiscWidth(n)*W/450),drawDisc((2*e+1)*PEG_SPACE-width/2,H-deltaH-(t+1)*DISC_HEIGHT,width))}}function ende(){return pegTop[2]==discs-1}function solve(e,t,n,o){0!=e&&(solve(e-1,t,o,n),moveDisc(t,o),solut[Anzahl][0]=t,solut[Anzahl][1]=o,Anzahl++,solve(e-1,n,t,o))}function Board(e){discs=e;for(var t=0;e>t;t++)peg[t][0]=e-t;pegTop[0]=e-1;for(var n=1;3>n;n++)pegTop[n]=-1;for(var o=e-1;o>=0;o--)discWidth[o]=SIZE[e-3][0]-SIZE[e-3][1]*(e-1-o);moveCount=0,minMoves=Math.floor(Math.pow(2,e))-1}function zeichne(){ctx.clearRect(0,0,W,H),ctx.drawImage(BoardI,0,0,W,H),drawBoard()}function moveDisc1(e,t,n){return t>=0&&n>=0&&t!=n&&(pegTop[n]<0||peg[pegTop[n]][n]>e)?(setDisc(e,n),moveCount++,!0):(document.getElementById("message").innerHTML="Ungültiger Zug",setDisc(e,t),!1)}function moveDisc(e,t){setDisc(getTopDisc(e),t),moveCount++}function setDisc(e,t){peg[++pegTop[t]][t]=e}function getDisc(e,t){return peg[e][t]}function getTopDisc(e){return peg[pegTop[e]--][e]}function getPegTop(e){return pegTop[e]}function getDiscWidth(e){return discWidth[e-1]}function isStartPeg(e){return e>=0&&pegTop[e]>=0}function drawDisc(e,t,n){ctx.fillStyle="white",ctx.rect(e,t,n,DISC_HEIGHT-2),ctx.fill(),ctx.beginPath(),ctx.strokeStyle=COLOR_3,ctx.moveTo(e+4,t),ctx.lineTo(e+n-4,t),ctx.moveTo(e+2,t+1),ctx.lineTo(e+n-2,t+1),ctx.stroke(),ctx.beginPath(),ctx.rect(e,t+7,n,1),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle=COLOR_4,ctx.moveTo(e+1,t+2),ctx.lineTo(e+n-1,t+2),ctx.stroke(),ctx.beginPath(),ctx.rect(e,t+5,n,1),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle=COLOR_5,ctx.moveTo(e+1,t+3),ctx.lineTo(e+n-1,t+3),ctx.moveTo(e,t+4),ctx.lineTo(e+n,t+4),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle=COLOR_2,ctx.rect(e,t+9,n,1),ctx.stroke(),ctx.beginPath(),ctx.moveTo(e+1,t+11),ctx.lineTo(e+n-1,t+11),ctx.stroke(),DISC_HEIGHT>11&&(ctx.beginPath(),ctx.strokeStyle=COLOR_1,ctx.moveTo(e+1,t+12),ctx.lineTo(e+n-1,t+12),DISC_HEIGHT>12&&(ctx.moveTo(e+2,t+13),ctx.lineTo(e+n-2,t+13)),DISC_HEIGHT>13&&(ctx.moveTo(e+4,t+14),ctx.lineTo(e+n-4,t+14)),ctx.stroke())}function solution(){doClear(),Anzahl=0,solve(discs,0,1,2),doClear(),document.getElementById("Zug+").disabled=!1,zugplus(),document.getElementById("message").innerHTML="Lösungsmodus: Klicken Sie auf Zug+"}function zugplus(){minMoves>moveCount&&(moveDisc(solut[moveCount][0],solut[moveCount][1]),zeichne(),document.getElementById("Anz").innerHTML=moveCount),moveCount==minMoves&&(document.getElementById("message").innerHTML="Ziel erreicht!",document.getElementById("Zug+").disabled=!0)}function getMousePos(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}var W,H,canvas1,ctx;PEG1=0,PEG2=1,PEG3=2,PEGS=3,COLOR_1="#663300",COLOR_2="#996600",COLOR_3="#cc9933",COLOR_4="#ffcc00",COLOR_5="#ffffcc";var PEG_SPACE,DISC_HEIGHT,deltaH,discs,sourceDisc,sourcePeg,targetPeg,sourcePeg_gewaehlt=!1,moveCount=0,minMoves;SIZE=[[68,18],[76,16],[84,14],[92,13],[100,12],[108,12],[112,11],[116,10],[120,9],[124,9]];for(var peg=new Array(10),i=0;i<peg.length;++i)peg[i]=new Array(3);for(var pegTop=new Array,discWidth=new Array,BoardI,solut=new Array(Math.pow(2,10)),i=0;i<solut.length;++i)solut[i]=new Array(2);var initmade=!1;window.onload=function(){BoardI=document.getElementById("boardpng"),resizeCanvas()};