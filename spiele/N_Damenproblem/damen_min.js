function init(){canvas=document.getElementById("myCanvas"),ctx=canvas.getContext("2d");for(var e=0;12>e;e++)board[e]=new Array(12);for(var e=0;1788>e;e++)loesung[e]=new Array(12);zeichne()}function zeichne(){ctx.clearRect(0,0,W,W);var e=W/N-1,t=e*N;ctx.beginPath();for(var a=0;N>=a;a++)ctx.moveTo(1,e*a+1),ctx.lineTo(t+1,e*a+1);for(var r=0;N>=r;r++)ctx.moveTo(e*r+1,1),ctx.lineTo(e*r+1,t+1);ctx.stroke()}function set(e,t){var a=W/N-1;ctx.beginPath(),ctx.fillStyle="blue",ctx.arc((e+.5)*a,(t+.5)*a,(a-20)/2,0,2*Math.PI),ctx.fill()}function clear(e,t){var a=W/N-1;ctx.beginPath(),ctx.fillStyle="white",ctx.fillRect(e*a+2,t*a+2,a-2,a-2)}function Start(){stop=!0,document.getElementById("run_stop").disabled=!0,N=parseInt(document.getElementById("Anz").value),4>N&&(N=4),N>12&&(N=12),document.getElementById("Anz").value=N,ende=Math.ceil(N/2),zeichne(),LZ=0,Weiter=!0;for(var e=0;12>e;e++)for(var t=0;12>t;t++)board[e][t]=!1;stop=!1,document.getElementById("run_stop").value="Stop",document.getElementById("run_stop").disabled=!1,document.getElementById("run_stop").onclick=function(){stop?(stop=!1,document.getElementById("run_stop").value="Stop",document.getElementById("label2").firstChild.data="Zum Anhalten klicken Sie auf Stop",document.getElementById("start").disabled=!0,NeueStellung(),runstep()):(document.getElementById("run_stop").value="Go",stop=!0)},document.getElementById("start").disabled=!0,geschlagen=!1,anzahl=0,eff_anz=0;for(var a=0;N>a;a++)x1[a]=0;document.getElementById("label2").firstChild.data="Zum Anhalten klicken Sie auf Stop",set(0,0),document.getElementById("label").firstChild.data="Anzahl Lösungen: 0",document.getElementById("label1").firstChild.data="Effektive Anzahl nichtkongruenter Lösungen: 0",runstep()}function step(){if(test(),!geschlagen){if(LZ==N-1){var e=!0;anzahl++,testaufkongruenz(),nostop=document.getElementById("ohneHalt").checked,nostop?NeueStellung():(stop=!0,document.getElementById("start").disabled=!1,document.getElementById("run_stop").value="Go",document.getElementById("label2").firstChild.data="Für Weiter klicken Sie auf Go")}else LZ++,x1[LZ]=0,set(0,LZ);e||runstep()}}function test(){geschlagen=Dame_geschlagen(),geschlagen&&(timer=setTimeout(function(){NeueStellung()},delay))}function runstep(){Weiter?step():(document.getElementById("start").disabled=!1,stop?document.getElementById("label2").firstChild.data="Für Weiter klicken Sie auf Go":(document.getElementById("label2").firstChild.data="Fertig! Für Neustart klicken Sie auf Start",document.getElementById("run_stop").disabled=!0))}function Dame_geschlagen(){for(var e=0;LZ>e;e++){if(x1[e]==x1[LZ])return!0;if(Math.abs(x1[e]-x1[LZ])==LZ-e)return!0}return!1}function NeueStellung(){for(delay=document.getElementById("Delay").value,clear(x1[LZ],LZ);++x1[LZ]>=N&&LZ>0;)LZ--,clear(x1[LZ],LZ);set(x1[LZ],LZ),Weiter=(x1[0]!=ende||0!=LZ)&&!stop,geschlagen=!1,clearTimeout(timer),runstep()}function gostep(){document.getElementById("run_stop").disabled=!0,document.getElementById("stopbutton").disabled=!1,document.getElementById("label2").firstChild.data="Ich rechne ...",NeueStellung()}function setzeboard(){for(var e=0;N>e;e++)for(var t=0;N>t;t++)board[e][t]=!1;for(var a=0;N>a;a++)board[a][x1[a]]=!0}function testaufkongruenz(){setzeboard();for(var e=!1,t=0;eff_anz>t;t++)e=sameboard(t),e&&(t=eff_anz);if(e)document.getElementById("label").firstChild.data="Lösung "+anzahl+" : alt!",document.getElementById("label1").firstChild.data="Anzahl nichtkongruenter Lösungen: "+eff_anz;else{for(var a=0;N>a;a++)loesung[eff_anz][a]=x1[a];eff_anz++,document.getElementById("label").firstChild.data="Lösung "+anzahl+" : neu!",document.getElementById("label1").firstChild.data="Anzahl nichtkongruenter Lösungen: "+eff_anz}}function sameboard(e){oboard=new Array(N);for(var t=0;N>t;t++)oboard[t]=new Array(N);for(var a=0;N>a;a++)for(var r=0;N>r;r++)oboard[a][r]=!1;for(var a=0;N>a;a++)oboard[a][loesung[e][a]]=!0;return testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=mirrorMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard)?!0:(oboard=rotateMatrix(oboard),testEqualMatrix(oboard))))))))}function testEqualMatrix(e){for(var t=0;N>t;t++)for(var a=0;N>a;a++)if(board[t][a]!=e[t][a])return!1;return!0}function rotateMatrix(e){result=new Array(N);for(var t=0;N>t;t++)result[t]=new Array(N);for(var a=0;N>a;a++)for(var r=0;N>r;r++)result[N-1-r][a]=e[a][r];return result}function mirrorMatrix(e){result=new Array(N);for(var t=0;N>t;t++)result[t]=new Array(N);for(var a=0;N>a;a++)for(var r=0;N>r;r++)result[r][a]=e[a][r];return result}var N=8,W=320,canvas,ctx;x1=new Array(12);var anzahl=0,eff_anz=0;loesung=new Array(1788),board=new Array(12);var ende,Weiter,LZ,nostop=!0,timer,delay=100,geschlagen=!1,stop=!1;window.onload=init;