var W;var Ho;const g=9.80665;const l=1;const pl=70;var Phi=[0,2.84,0,-1.57,0];var Phialt=[0,0,0,0,0];var k=[0,0,0,0,0];var x1,y1,x2,y2;var h;var ctx;var canvas1;var initmade=false;var timer;delay=50;var Weiter=false;var stop;window.onload=resizeCanvas;function resizeCanvas(){var a=document.getElementById("containercanvas");a.width=a.offsetWidth;W=a.width;if(W>400){W=400}Ho=0.8*W;if(initmade){resize1();Zeichne();dorun()}else{init()}}function init(){initmade=true;window.addEventListener("resize",function(a){resizeCanvas()});canvas1=document.getElementById("myCanvas");resize1();ctx=canvas1.getContext("2d");start()}function resize1(){canvas1.width=W;canvas1.height=Ho}function start(){Phi[1]=parseFloat(document.getElementById("PHI1").value);if(Phi[1]>Math.PI){Phi[1]=Phi[1]-2*Math.PI;document.getElementById("PHI1").value=Phi[1]}if(Phi[1]<-Math.PI){Phi[1]=Phi[1]+2*Math.PI;document.getElementById("PHI1").value=Phi[1]}Phi[3]=parseFloat(document.getElementById("PHI2").value);if(Phi[3]>Math.PI){Phi[3]=Phi[3]-2*Math.PI;document.getElementById("PHI2").value=Phi[3]}if(Phi[3]<-Math.PI){Phi[3]=Phi[3]+2*Math.PI;document.getElementById("PHI2").value=Phi[3]}h=parseFloat(document.getElementById("Schrittweite").value);if(h<0.0001){h=0.0001;document.getElementById("Schrittweite").value=h}if(h>0.04){h=0.04;document.getElementById("Schrittweite").value=h}Phi[2]=0;Phi[4]=0;x1=W/2;y1=140;x2=x1;y2=y1;ctx.lineWidth="1";ctx.font="12px Arial";Zeichne()}function dostep(){stop=true;timer=setTimeout(function(){action()},delay);Runge();Zeichne();dorun()}function run(){Weiter=!Weiter;if(Weiter){document.getElementById("STEP").disabled=true;document.getElementById("RUN").value="Stop"}else{document.getElementById("STEP").disabled=false;document.getElementById("RUN").value="Run"}stop=false;dorun()}function action(){stop=false;clearTimeout(timer);dorun()}function dorun(){if(!stop&&Weiter){dostep()}}function f(b,a,m,j){var e,c,i;e=9*l*Math.sin(2*b-2*m);c=l*Math.sin(b-m);i=9*l*Math.cos(2*b-2*m)-23*l;k[1]=a;k[2]=(27*g*Math.sin(b)+9*g*Math.sin(b-2*m)+e*a*a+12*c*j*j)/i;k[3]=j;k[4]=(21*g*Math.sin(m)-27*g*Math.sin(2*b-m)-e*j*j-48*c*a*a)/i}function Runge(){var m;var j=[0,0,0,0,0];var e=[0,0,0,0,0];var o=[0,0,0,0,0];var n=[0,0,0,0,0];f(Phi[1],Phi[2],Phi[3],Phi[4]);for(m=1;m<=4;m++){j[m]=k[m]}for(m=1;m<=4;m++){Phialt[m]=Phi[m]+(h/2)*j[m]}f(Phialt[1],Phialt[2],Phialt[3],Phialt[4]);for(m=1;m<=4;m++){e[m]=k[m]}for(m=1;m<=4;m++){Phialt[m]=Phi[m]+(h/2)*e[m]}f(Phialt[1],Phialt[2],Phialt[3],Phialt[4]);for(m=1;m<=4;m++){o[m]=k[m]}for(m=1;m<=4;m++){Phialt[m]=Phi[m]+h*o[m]}f(Phialt[1],Phialt[2],Phialt[3],Phialt[4]);for(m=1;m<=4;m++){n[m]=k[m]}for(m=1;m<=4;m++){Phi[m]=Phi[m]+(h/6)*(j[m]+2*e[m]+2*o[m]+n[m])}if(Phi[1]>Math.PI){Phi[1]=Phi[1]-2*Math.PI}if(Phi[1]<-Math.PI){Phi[1]=Phi[1]+2*Math.PI}if(Phi[3]>Math.PI){Phi[3]=Phi[3]-2*Math.PI}if(Phi[3]<-Math.PI){Phi[3]=Phi[3]+2*Math.PI}}function line(c,e,a,d,b){ctx.beginPath();ctx.strokeStyle=b;ctx.moveTo(c,e);ctx.lineTo(a,d);ctx.stroke();ctx.endPath}function Zeichne(){var a;ctx.clearRect(0,0,W,Ho);ctx.strokeStyle="red";ctx.strokeText("Phi1 = ",10,100);ctx.strokeText("Phi1' = ",10,120);ctx.strokeStyle="blue";ctx.strokeText("Phi2 = ",10,150);ctx.strokeText("Phi2' = ",10,170);x1=Math.round(pl*Math.sin(Phi[1]))+W/2;y1=Math.round(pl*Math.cos(Phi[1]))+140;x2=Math.round(pl*Math.sin(Phi[3]))+x1;y2=Math.round(pl*Math.cos(Phi[3]))+y1;line(W/2,140,x1,y1,"red");a=Phi[1].toString();a=a.substr(0,5);ctx.strokeText(a,50,100);a=Phi[2].toString();a=a.substr(0,5);ctx.strokeText(a,50,120);line(x1,y1,x2,y2,"blue");a=Phi[3].toString();a=a.substr(0,5);ctx.strokeText(a,50,150);a=Phi[4].toString();a=a.substr(0,5);ctx.strokeText(a,50,170)};