function resizeCanvas(){var e=document.getElementById("containercanvas");e.width=e.offsetWidth,W=e.width,W>400&&(W=400),H=W,initmade?(resize1(),zeichne()):init()}function init(){initmade=!0,window.addEventListener("resize",function(){resizeCanvas()}),canvas1=document.getElementById("myCanvas"),resize1(),ctx=canvas1.getContext("2d"),term="(z*z-1)/(z-2+i)",zeichne()}function resize1(){canvas1.width=W,canvas1.height=H}function palette1(){palet1||(palet1=!0,zeichne())}function palette2(){palet1&&(palet1=!1,zeichne())}function zeichne(){for(var e=ctx.getImageData(0,0,W,H),r=new ArrayBuffer(e.data.length),a=new Uint8ClampedArray(r),t=new Uint32Array(r),n=(X1-X0)/W,i=(Y1-Y0)/H,c=0;W>c;c++)for(var l=0;H>l;l++){var u=X0+n*c,d=Y1-i*l,h=parseterm(term,u,d),s=h[0]*h[0]+h[1]*h[1],f=-Math.atan2(h[1],h[0]);0>f&&(f+=2*Math.PI);var o=Math.floor(3*f/Math.PI),v=Math.round(765/Math.PI*(f-o*Math.PI/3));if(palet1){var m=90;1>=s?m=255:s>1&&4>=s?m=200:s>4&&9>=s&&(m=145);var z=hexadez(v),p=hexadez(255-v);switch(o){case 0:Red="FF",Green="00",Blue=z;break;case 1:Red=p,Green="00",Blue="FF";break;case 2:Red="00",Green=z,Blue="FF";break;case 3:Red="00",Green="FF",Blue=p;break;case 4:Red=z,Green="FF",Blue="00";break;default:Red="FF",Green=p,Blue="00"}}else{var m=255;switch(o){case 0:Red=75,Green=0,Blue=v;break;case 1:Red=255-v,Green=0,Blue=75;break;case 2:Red=0,Green=v,Blue=75;break;case 3:Red=0,Green=75,Blue=255-v;break;case 4:Red=v,Green=75,Blue=0;break;default:Red=75,Green=255-v,Blue=0}}var g="0x"+Red+Green+Blue;t[l*W+c]=m<<24|(255&g)<<16|65280&g|g>>16}e.data.set(a),ctx.putImageData(e,0,0)}function einlesen(){var e=!1;ctx.clearRect(0,0,W,H),term=document.getElementById("f").value;for(var r=0,a=0,t="0123456789+-*/zi()",n=0;n<term.length;n++){var i=term.charAt(n);-1==t.indexOf(i)&&(e=!0,alert("UngÃ¼ltiges Zeichen")),"("==i&&r++,")"==i&&a++}if(r!=a&&(e=!0,alert("Fehler bei Anzahl Klammern")),("*"==term.charAt(0)||"/"==term.charAt(0))&&(e=!0,alert("1.Zeichen darf nicht * oder / sein")),!e)for(n=0;n<term.length-1;n++){if(i=term.charAt(n),"+"==i||"-"==i||"*"==i||"/"==i)var c=!0;if("("==i||")"==i)var l=!0;var u=term.charAt(n+1);if(!c||"+"!=u&&"-"!=u&&"*"!=u&&"/"!=u?c=!1:(e=!0,alert("2 Opzeichen hintereinander")),!l||"("!=u&&")"!=u?l=!1:(e=!0,alert("2 Klammern hintereinander")),i>="0"&&"9">=i||"i"==i||"z"==i)var d=!0;d&&(u>="0"&&"9">=u||"i"==u||"z"==u)?(e=!0,alert("Zahl>9 oder Opzeichen zwischen zwei Zeichen fehlt")):d=!1}e||(("-"==term.charAt(0)||"+"==term.charAt(0))&&(term="0"+term),zeichne())}function sum(e,r,a,t){return[e+a,r+t]}function product(e,r,a,t){var n=(e-r)*(a+t),i=r*a,c=e*t;return[n+i-c,i+c]}function quot(e,r,a,t){var n=a*a+t*t,i=product(e,r,a,-t);return[i[0]/n,i[1]/n]}function hexadez(e){var r=e%16,a=(e-r)/16;return r>9&&(r=String.fromCharCode(r+55)),a>9&&(a=String.fromCharCode(a+55)),""+a+r}function parseterm(e,r,a){for(var t=new Array,n=0,i="",c=0;c<e.length;c++){var l=e.charAt(c);if("("==l){var u=e.indexOf(")"),d=e.slice(c+1,u),h=parseterm1(d,r,a);t[n]=h[0],n++,t[n]=h[1],n++,e=e.replace(")"," "),c=u}if(""==i)"z"==l&&(t[n]=r,n++,t[n]=a,n++),"i"==l&&(t[n]=0,n++,t[n]=1,n++),l>="0"&&"9">=l&&(t[n]=parseInt(l),n++,t[n]=0,n++),("+"==l||"-"==l||"*"==l||"/"==l)&&(i=l);else{if("z"==l&&(t[n]=r,n++,t[n]=a,n++),"i"==l&&(t[n]=0,n++,t[n]=1,n++),l>="0"&&"9">=l&&(t[n]=parseInt(l),n++,t[n]=0,n++),"*"==i)var s=product(t[n-4],t[n-3],t[n-2],t[n-1]);if("+"==i)var s=sum(t[n-4],t[n-3],t[n-2],t[n-1]);if("-"==i)var s=sum(t[n-4],t[n-3],-t[n-2],-t[n-1]);if("/"==i)var s=quot(t[n-4],t[n-3],t[n-2],t[n-1]);t[n-2]=s[0],t[n-1]=s[1],i=""}}return[t[n-2],t[n-1]]}function parseterm1(e,r,a){for(var t=new Array,n=0,i="",c=0;c<e.length;c++){var l=e.charAt(c);if(""==i)"z"==l&&(t[n]=r,n++,t[n]=a,n++),"i"==l&&(t[n]=0,n++,t[n]=1,n++),l>="0"&&"9">=l&&(t[n]=parseInt(l),n++,t[n]=0,n++),("+"==l||"-"==l||"*"==l||"/"==l)&&(i=l);else{if("z"==l&&(t[n]=r,n++,t[n]=a,n++),"i"==l&&(t[n]=0,n++,t[n]=1,n++),l>="0"&&"9">=l&&(t[n]=parseInt(l),n++,t[n]=0,n++),"*"==i)var u=product(t[n-4],t[n-3],t[n-2],t[n-1]);if("+"==i)var u=sum(t[n-4],t[n-3],t[n-2],t[n-1]);if("-"==i)var u=sum(t[n-4],t[n-3],-t[n-2],-t[n-1]);if("/"==i)var u=quot(t[n-4],t[n-3],t[n-2],t[n-1]);t[n-2]=u[0],t[n-1]=u[1],i=""}}return[t[n-2],t[n-1]]}X0=-3,X1=3,Y0=-3,Y1=3;var term,canvas1,ctx,initmade=!1,W,H,palet1=!0;window.onload=function(){resizeCanvas()};