var W;var H;deltax=40;xmax=9;xmin=-1;ymax=8;ymin=-1;x0=5.5;x1=6;var canvas1;var ctx;var px=3;var qx=8;var py,qy;var mode=0;var moder=2;var mousedown=false;var initmade=false;window.onload=resizeCanvas;function resizeCanvas(){var a=document.getElementById("containercanvas");a.width=a.offsetWidth;W=a.width;if(W>400){W=400}H=0.9375*W;if(initmade){resize1();zeichne()}else{init()}}function init(){initmade=true;window.addEventListener("resize",function(a){resizeCanvas()});canvas1=document.getElementById("myCanvas");resize1();ctx=canvas1.getContext("2d");py=f(px);qy=f(qx);document.getElementById(mode).style.backgroundColor="#00FF00";document.getElementById(moder).style.backgroundColor="#00FF00";canvas1.addEventListener("mousedown",function(a){mousedown=true},false);canvas1.addEventListener("mouseup",function(a){mousedown=false},false);canvas1.addEventListener("mousemove",function(b){if(mousedown){var a=getMousePos(canvas1,b);if(moder==2){px=invmap(0,a.x);if(mode==0&(px>=x0)){px=x0}if(mode==1&(px>=x1)){px=x1}if(px<=xmin){px=xmin}py=f(px);zeichne()}if(moder==3){qx=invmap(0,a.x);if(qx>=xmax){qx=xmax}if(mode==0&(qx<=x0)){qx=x0}if(mode==1&(qx<=x1)){qx=x1}qy=f(qx);zeichne()}}},false);zeichne()}function resize1(){canvas1.width=W;canvas1.height=H}function button0(){document.getElementById(mode).style.backgroundColor="#E0FFFF";mode="0";document.getElementById(mode).style.backgroundColor="#00FF00";px=3;py=f(px);qx=8;qy=f(qx);zeichne()}function button1(){document.getElementById(mode).style.backgroundColor="#E0FFFF";mode="1";document.getElementById(mode).style.backgroundColor="#00FF00";px=3;py=f(px);qx=8;qy=f(qx);zeichne()}function buttonl(){document.getElementById(moder).style.backgroundColor="#E0FFFF";moder="2";document.getElementById(moder).style.backgroundColor="#00FF00";px=3;py=f(px);zeichne()}function buttonr(){document.getElementById(moder).style.backgroundColor="#E0FFFF";moder="3";document.getElementById(moder).style.backgroundColor="#00FF00";qx=8;qy=f(qx);zeichne()}function Line(b,d,a,c){ctx.beginPath();ctx.moveTo(map(0,b),map(1,d));ctx.lineWidth="1";ctx.lineTo(map(0,a),map(1,c));ctx.stroke()}function map(a,b){s=2;if(a<0.5){s=(b-xmin)/(xmax-xmin)*W}if(a>0.5){s=(ymax-b)/(ymax-ymin)*H}return s}function invmap(a,b){ss=2;if(a<0.5){ss=xmin+(b*(xmax-xmin))/W}if(a>0.5){ss=(-b*(ymax-ymin))/H-ymin}return ss}function koordsys(){var a=map(1,0);Line(xmin,0,xmax,0);Line(1,-0.03,1,0.03);ctx.strokeText("1",map(0,1)-4,map(1,0)+12);ctx.beginPath();ctx.moveTo(W-5,a-5);ctx.lineTo(W,a);ctx.moveTo(W-5,a+5);ctx.lineTo(W,a);ctx.stroke();var b=map(0,0);Line(0,ymin,0,ymax);Line(-0.03,1,0.03,1);ctx.strokeText("1",map(0,0)-12,map(1,1));ctx.beginPath();ctx.moveTo(b-5,5);ctx.lineTo(b,0);ctx.moveTo(b+5,5);ctx.lineTo(b,0);ctx.stroke()}function zeichne(){var c=1;if(moder==3){c=2}ctx.clearRect(0,0,W,H);ctx.beginPath();ctx.strokeStyle="black";ctx.lineWidth="1";koordsys();for(i=0;i<=deltax;i++){var a;if(i==0){a=(i/deltax)*(x0-xmin)+xmin}else{a=((i-1)/deltax)*(x0-xmin)+xmin}var b=(i/deltax)*(x0-xmin)+xmin;var g=f(a);var d=f(b);Line(a,g,b,d)}for(i=0;i<=deltax;i++){if(i==0){a=(i/deltax)*(xmax-x0)+x0}else{a=((i-1)/deltax)*(xmax-x0)+x0}b=(i/deltax)*(xmax-x0)+x0;g=f(a);d=f(b);Line(a,g,b,d)}if(mode==0){var e=Math.round(1000*(f(x0)-py)/(x0-px))/1000;if(Math.abs(px-x0)>=0.01&&(c==1)){ctx.strokeStyle="red";Zeichne(px,py,x0,f(x0));if((x0-px)>=0.01){lsteig.innerHTML=e}}if(Math.abs(px-x0)<0.01&&(c==1)){ctx.strokeStyle="blue";Line(xmin,ldf(xmin),xmax,ldf(xmax));ctx.font="16px sans-serif";ctx.fillText("Linksseitige Ableitung",40,20);lsteig.innerHTML=2*x0/5}e=Math.round(1000*(f(x0)-qy)/(x0-qx))/1000;if(Math.abs(qx-x0)>=0.01&&(c==2)){ctx.strokeStyle="red";Zeichne(qx,qy,x0,f(x0));if((qx-x0)>=0.01){rsteig.innerHTML=e}}if(Math.abs(qx-x0)<0.01&&(c==2)){ctx.strokeStyle="blue";Line(xmin,rdf(xmin),xmax,rdf(xmax));ctx.font="16px sans-serif";ctx.fillText("Rechtsseitige Ableitung",40,20);rsteig.innerHTML=0}ctx.strokeStyle="gray";Line(x0,f(x0),x0,0);ctx.strokeStyle="black";ctx.font="12px sans-serif";ctx.strokeText("x0",map(0,x0)-2,map(1,0)+12)}if(mode==1){var e=Math.round(1000*(f(x1)-py)/(x1-px))/1000;if(Math.abs(px-x1)>=0.01&&(c==1)){ctx.strokeStyle="red";Zeichne(px,py,x1,f(x1));if((x1-px)>=0.01){lsteig.innerHTML=e}}if(Math.abs(px-x1)<0.01&&(c==1)){ctx.strokeStyle="blue";Line(xmin,df(xmin),xmax,df(xmax));ctx.font="16px sans-serif";ctx.fillText("Linksseitige Ableitung",40,20);lsteig.innerHTML=-2*(x1-x0)/5}e=Math.round(1000*(f(x1)-qy)/(x1-qx))/1000;if(Math.abs(qx-x1)>=0.01&&(c==2)){ctx.strokeStyle="red";Zeichne(qx,qy,x1,f(x1));if((qx-x0)>=0.01){rsteig.innerHTML=e}}if(Math.abs(qx-x1)<0.01&&(c==2)){ctx.strokeStyle="blue";Line(xmin,df(xmin),xmax,df(xmax));ctx.font="16px sans-serif";ctx.fillText("Rechtsseitige Ableitung",40,20);rsteig.innerHTML=-2*(x1-x0)/5}ctx.strokeStyle="gray";Line(x1,f(x1),x1,0);ctx.strokeStyle="black";ctx.font="12px sans-serif";ctx.strokeText("x1",map(0,x1),map(1,0)+12)}ctx.strokeStyle="gray";if(c==1){Line(px,py,px,0)}if(c==2){Line(qx,qy,qx,0)}if(c==1){ctx.beginPath();ctx.strokeStyle="red";ctx.arc(map(0,px),map(1,py),2,0,2*Math.PI);ctx.fillStyle="red";ctx.fill();ctx.stroke()}if(c==2){ctx.beginPath();ctx.strokeStyle="red";ctx.arc(map(0,qx),map(1,qy),2,0,2*Math.PI);ctx.fillStyle="red";ctx.fill();ctx.stroke()}if(mode==0){ctx.beginPath();ctx.strokeStyle="blue";ctx.arc(map(0,x0),map(1,f(x0)),2,0,2*Math.PI);ctx.fillStyle="blue";ctx.fill();ctx.stroke()}if(mode==1){ctx.beginPath();ctx.strokeStyle="blue";ctx.arc(map(0,x1),map(1,f(x1)),2,0,2*Math.PI);ctx.fillStyle="blue";ctx.fill();ctx.stroke()}ctx.strokeStyle="black";ctx.font="12px sans-serif";if(c==1){ctx.strokeText("x",map(0,px)-2,map(1,0)+12)}if(c==2){ctx.strokeText("x",map(0,qx)-2,map(1,0)+12)}ctx.stroke()}function dostep(){if(mode==0){if(moder==2){if(px<x0){px=px+0.1;if(px>x0){px=x0}py=f(px);zeichne()}}if(moder==3){if(qx>x0){qx=qx-0.1;if(qx<x0){qx=x0}qy=f(qx);zeichne()}}}if(mode==1){if(moder==2){if(px<x1){px=px+0.1;if(px>x1){px=x1}py=f(px);zeichne()}}if(moder==3){if(qx>x1){qx=qx-0.1;if(qx<x1){qx=x1}qy=f(qx);zeichne()}}}}function Zeichne(b,h,a,g){if(Math.abs(b-a)<0.01){Line(b,ymin,b,ymax)}if(Math.abs(b-a)>=0.01){var e=(g-h)/(a-b);var c=xmin;var k=e*(xmin-b)+h;var j=xmax;var d=e*(xmax-b)+h;Line(c,k,j,d)}}function getMousePos(b,a){var c=b.getBoundingClientRect();return{x:a.clientX-c.left,y:a.clientY-c.top}}function f(a){s=0;if(a<x0){s=(a*a)/5+0.5}if(a>=x0){s=(-(a-x0)*(a-x0))/5+(x0*x0)/5+0.5}return s}function df(a){s=0;if(x1<x0){s=f(x1)+((2*x1)/5)*(a-x1)}if(x1>=x0){s=((-2*(x1-x0))/5)*(a-x1)+f(x1)}return s}function ldf(a){s=0;s=f(x0)+((2*x0)/5)*(a-x0);return s}function rdf(a){s=0;s=f(x0);return s};