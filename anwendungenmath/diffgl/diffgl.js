function ok1(){hilf=document.getElementById("x0").value;var check=pruefe_grenze(hilf);if(!check)return!1;if(Xmin=eval(hilf),isNaN(Xmin))return!1;x[0]=Xmin,hilf=document.getElementById("xe").value;var check=pruefe_grenze(hilf);return check?(Xmax=eval(hilf),isNaN(Xmax)?!1:(DiffX=Xmax-Xmin,0>=DiffX?!1:(Ymin=document.getElementById("ymin").value,Ymax=document.getElementById("ymax").value,DiffY=Ymax-Ymin,0>=DiffY?!1:!0))):!1}function pruefe_grenze(e){return e.split(",").length-1>0?!1:e.split(".").length-1>1?!1:e.length>2&&"-"==e.charAt(0)&&"0"==e.charAt(1)&&"."!=e.charAt(2)?!1:e.length>1&&"0"==e.charAt(0)&&"."!=e.charAt(1)?!1:!0}function f(x,y){return hilf=eval(term)}function resizeCanvas(){var e=document.getElementById("containercanvas");e.width=e.offsetWidth,W=e.width,W>400&&(W=400),H=W,initmade?(resize1(),reset()):init()}function init(){initmade=!0,window.addEventListener("resize",function(){resizeCanvas()}),canvas1=document.getElementById("myCanvas"),resize1(),ctx=canvas1.getContext("2d"),reset()}function resize1(){canvas1.width=W,canvas1.height=H}function reset(){if(document.getElementById("Step").disabled=!1,document.getElementById("Run").disabled=!1,y[0]=parseFloat(document.getElementById("y0").value),h=parseFloat(document.getElementById("h").value),0>=h&&(h=.1,document.getElementById("h").value=h),iter=0,document.getElementById("x1").innerHTML="",document.getElementById("y1").innerHTML="",document.getElementById("x2").innerHTML="",document.getElementById("y2").innerHTML="",document.getElementById("x3").innerHTML="",document.getElementById("y3").innerHTML="",document.getElementById("x4").innerHTML="",document.getElementById("y4").innerHTML="",document.getElementById("x5").innerHTML="",document.getElementById("y5").innerHTML="",term=document.getElementById("f").value,ergaenze_term(),!ok1())return melde("Fehler bei Grenzen KS!"),void 0;try{var e=f(x[0],y[0])}catch(t){return Fehlerbehandlung(),void 0}return zeichneKS(),isNaN(e)?(melde("y' existiert nicht!"),void 0):(document.getElementById("message").innerHTML="Klick auf Run oder Step",void 0)}function dostep(){iter++,x[iter]=x[iter-1]+h,x[iter]<=Xmax&&h>1e-7?(y[iter]=rungekutta(x[iter-1],y[iter-1],h),zeichne(x[iter-1],y[iter-1],x[iter],y[iter]),schreibeWerte()):(x[iter]>Xmax&&melde("xe erreicht!"),1e-7>=h&&melde("h wird zu klein!"),document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0)}function run(){for(;x[iter]<=Xmax&&h>1e-7;)dostep();1e-7>=h&&melde("h wird zu klein!")}function rungekutta(e,t,n){var r,i,m,a,c;return Math.abs(n)>0&&(r=h*f(e,t),i=h*f(e+n/2,t+r/2),m=h*f(e+n/2,t+i/2),a=h*f(e+n,t+m),c=t+(r+2*i+2*m+a)/6,Math.abs((i-m)/(r-i))>.1?(h=.4*h,document.getElementById("h").value=runde(h)):Math.abs(h)<.1&&(h=1.1*h,document.getElementById("h").value=runde(h))),c}function melde(e){document.getElementById("message").innerHTML=e,document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0}function zeichneKS(){ctx.clearRect(0,0,W,H),ctx.beginPath(),ctx.strokeStyle="black",ctx.lineWidth="1",ctx.font="10px Arial";var e=row(0);ctx.moveTo(0,e),ctx.lineTo(W,e);var t=Math.floor(Xmin),n=Math.floor(Xmax),r=e,i=t;if(20>=DiffX)for(;n>=i;){var m=col(i);ctx.moveTo(m,r+3),ctx.lineTo(m,r-3),ctx.strokeText(i,m-3,r+10),i+=1}if(i=t+5-t%5,DiffX>20&&80>DiffX)for(;n>=i;){var m=col(i);ctx.moveTo(m,r+3),ctx.lineTo(m,r-3),ctx.strokeText(i,m-5,r+10),i+=5}ctx.moveTo(W-5,e-5),ctx.lineTo(W,e),ctx.moveTo(W-5,e+5),ctx.lineTo(W,e);var a=col(0);ctx.moveTo(a,0),ctx.lineTo(a,H);var c=Math.floor(Ymin),o=Math.floor(Ymax);m=a;var l=c;if(20>=DiffY)for(;o>=l;)0==l&&(l+=1),r=row(l),ctx.moveTo(m-3,r),ctx.lineTo(m+3,r),ctx.strokeText(l,m-12,r+3),l+=1;if(l=c+5-c%5,DiffY>20&&80>DiffY)for(;o>=l;)0==l&&(l+=5),r=row(l),ctx.moveTo(m-3,r),ctx.lineTo(m+3,r),ctx.strokeText(l,m-16,r+3),l+=5;ctx.moveTo(a-5,5),ctx.lineTo(a,0),ctx.moveTo(a+5,5),ctx.lineTo(a,0),ctx.stroke()}function zeichne(e,t,n,r){ctx.beginPath(),ctx.strokeStyle="red";var i=col(e),m=row(t),a=col(n),c=row(r);ctx.moveTo(i,m),ctx.lineTo(a,c),ctx.stroke()}function schreibeWerte(){var e=iter-1,t=iter-2,n=iter-3,r=iter-4;isNaN(x[r])||(document.getElementById("x1").innerHTML="x"+r+"="+runde(x[r]),document.getElementById("y1").innerHTML="y"+r+"="+runde(y[r])),isNaN(x[n])||(document.getElementById("x2").innerHTML="x"+n+"="+runde(x[n]),document.getElementById("y2").innerHTML="y"+n+"="+runde(y[n])),isNaN(x[t])||(document.getElementById("x3").innerHTML="x"+t+"="+runde(x[t]),document.getElementById("y3").innerHTML="y"+t+"="+runde(y[t])),document.getElementById("x4").innerHTML="x"+e+"="+runde(x[e]),document.getElementById("y4").innerHTML="y"+e+"="+runde(y[e]),document.getElementById("x5").innerHTML="x"+iter+"="+runde(x[iter]),document.getElementById("y5").innerHTML="y"+iter+"="+runde(y[iter])}function col(e){return(e-Xmin)/DiffX*W}function row(e){return(Ymax-e)/DiffY*H}function ergaenze_term(){term=term.replace(/asin/g,"hilfa"),term=term.replace(/acos/g,"hilfb"),term=term.replace(/atan/g,"hilfc"),term=term.replace(/sin/g,"Math.sin"),term=term.replace(/cos/g,"Math.cos"),term=term.replace(/tan/g,"Math.tan"),term=term.replace(/hilfa/g,"Math.asin"),term=term.replace(/hilfb/g,"Math.acos"),term=term.replace(/hilfc/g,"Math.atan"),term=term.replace(/abs/g,"Math.abs"),term=term.replace(/pow/g,"Math.pow"),term=term.replace(/sqrt/g,"Math.sqrt"),term=term.replace(/log/g,"Math.log"),term=term.replace(/ln/g,"Math.log"),term=term.replace(/exp/g,"Math.ixp"),term=term.replace(/e/g,"Math.E"),term=term.replace(/Math.ixp/g,"Math.exp"),term=term.replace(/pi/g,"Math.PI")}function runde(e){return Math.round(1e6*e)/1e6}function Fehlerbehandlung(){alert("Fehler im Funktionsterm. Bitte korrigieren.")}var W,H,Xmin,Xmax,Ymin,Ymax,ctx,DiffX,DiffY,term,h,x=new Array,y=new Array,iter=0,initmade=!1;window.onload=resizeCanvas;