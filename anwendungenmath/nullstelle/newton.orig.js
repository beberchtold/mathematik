function resizeCanvas(){var e=document.getElementById("containercanvas");e.width=e.offsetWidth,W=e.width,W>400&&(W=400),H=W,initmade?(resize1(),zeichneKS(),zeichne_funktion(),zeichne_x(xalt,"red"),zeichne_Tangente(y1,y2),isNaN(xneu)||zeichne_x(xneu,"blue")):init()}function ok1(){var hilf=document.getElementById("Xmin").value,check=pruefe_grenze(hilf);if(!check)return!1;if(Xmin=eval(hilf),isNaN(Xmin))return!1;hilf=document.getElementById("Xmax").value;var check=pruefe_grenze(hilf);return check?(Xmax=eval(hilf),isNaN(Xmax)?!1:(-Xmin==Xmax&&(Xmax=1.02*Xmax),DiffX=Xmax-Xmin,0>=DiffX?!1:!0)):!1}function pruefe_grenze(e){return e.split(",").length-1>0?!1:e.split(".").length-1>1?!1:e.length>2&&"-"==e.charAt(0)&&"0"==e.charAt(1)&&"."!=e.charAt(2)?!1:e.length>1&&"0"==e.charAt(0)&&"."!=e.charAt(1)?!1:!0}function f(x){return hilf=eval(term)}function init(){initmade=!0,window.addEventListener("resize",function(){resizeCanvas()}),canvas1=document.getElementById("myCanvas"),resize1(),ctx=canvas1.getContext("2d"),reset()}function resize1(){canvas1.width=W,canvas1.height=H}function reset(){document.getElementById("Step").disabled=!1,document.getElementById("Run").disabled=!1,epsilon=document.getElementById("eps").value,max_iters=document.getElementById("max").value,max_iters>100&&(max_iters=100,document.getElementById("max").value=max_iters),1>max_iters&&(max_iters=1,document.getElementById("max").value=max_iters),xalt=parseFloat(document.getElementById("x0").value),document.getElementById("xn").innerHTML="x0: "+xalt,document.getElementById("abl").innerHTML="              ",document.getElementById("xneu").innerHTML="              ",document.getElementById("yneu").innerHTML="              ",term=document.getElementById("f").value,ergaenze_term();try{yalt=f(xalt)}catch(e){return Fehlerbehandlung(),void 0}return ok1()?(DiffX=Xmax-Xmin,BerechneYGrenzen(),zeichneKS(),zeichne_funktion(),zeichne_x(xalt,"red"),isNaN(yalt)?(melde("Funktionswert von x0 existiert nicht!"),void 0):(document.getElementById("yn").innerHTML="y0: "+yalt,0==yalt?(melde("Nullstelle = "+xalt),document.getElementById("yn").innerHTML="y0: "+yalt,void 0):(document.getElementById("message").innerHTML="Klick auf Run oder Step",niters=0,void 0))):(melde("Fehler bei Grenzen KS!"),void 0)}function dostep(){niters++,niters>1&&(xalt=xneu,yalt=yneu);var e=get_deriv(xalt);if(isNaN(e)||e==-1/0||1/0==e)return melde("Ableitung bei xalt existiert nicht!"),document.getElementById("yn").innerHTML="y0: "+yalt,niters=max_iters,void 0;if(0!=e&&(xneu=xalt-yalt/e),y1=Tangentenpunkt(Xmin,e),y2=Tangentenpunkt(Xmax,e),zeichneKS(),zeichne_funktion(),zeichne_x(xalt,"red"),zeichne_Tangente(y1,y2),0==e)return melde("Ableitung bei "+xalt+" ist Null"),document.getElementById("yn").innerHTML="y0: "+yalt,niters=max_iters,void 0;yneu=f(xneu),zeichne_x(xneu,"blue");var t=niters-1;document.getElementById("xn").innerHTML="x"+t+": "+xalt,document.getElementById("yn").innerHTML="y"+t+": "+yalt,document.getElementById("abl").innerHTML="Steigung bei x"+t+": "+e,document.getElementById("xneu").innerHTML="x"+niters+": "+xneu,document.getElementById("yneu").innerHTML="y"+niters+": "+yneu,Math.abs(xneu-xalt)<epsilon?(yneu=f(xneu),document.getElementById("yneu").innerHTML="y"+niters+": "+yneu,document.getElementById("message").innerHTML="Ziel nach "+niters+" Schritten erreicht!",document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0):niters==max_iters&&(document.getElementById("message").innerHTML="Ziel nach "+niters+" Schritten nicht erreicht!",document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0)}function run(){for(0==niters&&dostep();Math.abs(xneu-xalt)>epsilon&&max_iters>niters;)dostep()}function melde(e){document.getElementById("yn").innerHTML="              ",document.getElementById("abl").innerHTML="              ",document.getElementById("xneu").innerHTML="              ",document.getElementById("yneu").innerHTML="              ",document.getElementById("message").innerHTML=e,document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0}function melde1(e){document.getElementById("message").innerHTML=e,document.getElementById("Step").disabled=!0,document.getElementById("Run").disabled=!0}function get_deriv(e){var t=DiffX/1e3;t>.001&&(t=.001);var n=e-t,i=e+t,r=f(n),a=f(i);return(a-r)/(2*t)}function zeichneKS(){ctx.clearRect(0,0,W,H),ctx.beginPath(),ctx.strokeStyle="black",ctx.lineWidth="1",ctx.font="10px Arial";var e=row(0);ctx.moveTo(0,e),ctx.lineTo(W,e);var t=Math.floor(Xmin),n=Math.floor(Xmax),i=e,r=t;if(20>=DiffX)for(;n>=r;){var a=col(r);ctx.moveTo(a,i+3),ctx.lineTo(a,i-3),ctx.strokeText(r,a-3,i+10),r+=1}if(r=t+5-t%5,DiffX>20&&80>DiffX)for(;n>=r;){var a=col(r);ctx.moveTo(a,i+3),ctx.lineTo(a,i-3),ctx.strokeText(r,a-5,i+10),r+=5}ctx.moveTo(W-5,e-5),ctx.lineTo(W,e),ctx.moveTo(W-5,e+5),ctx.lineTo(W,e);var m=col(0);ctx.moveTo(m,0),ctx.lineTo(m,H);var l=Math.floor(Ymin),c=Math.floor(Ymax);a=m;var o=l;if(20>=DiffY)for(;c>=o;)0==o&&(o+=1),i=row(o),ctx.moveTo(a-3,i),ctx.lineTo(a+3,i),ctx.strokeText(o,a-12,i+3),o+=1;if(o=l+5-l%5,DiffY>20&&80>DiffY)for(;c>=o;)0==o&&(o+=5),i=row(o),ctx.moveTo(a-3,i),ctx.lineTo(a+3,i),ctx.strokeText(o,a-16,i+3),o+=5;ctx.moveTo(m-5,5),ctx.lineTo(m,0),ctx.moveTo(m+5,5),ctx.lineTo(m,0),ctx.stroke()}function zeichne_x(e,t){ctx.beginPath(),ctx.strokeStyle=t;var n=col(e);ctx.moveTo(n,0),ctx.lineTo(n,H),ctx.stroke()}function zeichne_funktion(){ctx.beginPath(),ctx.strokeStyle="green";for(var e=Xmin,t=DiffX/W;isNaN(f(e));)e+=t;var n=f(e),i=row(n),r=col(e);ctx.moveTo(r,i);for(var a=r+1;W>a;a++){e=Xmin+DiffX/W*a;var m=f(e);Math.abs(m-n)<DiffY/2&&!isNaN(m)?ctx.lineTo(a,row(m)):ctx.moveTo(a,row(m)),n=m}ctx.stroke()}function zeichne_Tangente(e,t){ctx.beginPath(),ctx.strokeStyle="red",ctx.moveTo(0,row(e)),ctx.lineTo(W,row(t)),ctx.stroke()}function BerechneYGrenzen(){for(var e=Xmin,t=DiffX/100;isNaN(f(e));)e+=t;for(Ymin=f(e),Ymax=Ymin;Xmax>=e+t;){e+=t;var n=f(e);!isNaN(n)&&Ymin>n&&(Ymin=n),!isNaN(n)&&n>Ymax&&(Ymax=n)}DiffY=Ymax-Ymin,50>DiffY&&(Ymin-=.1*DiffY,Ymax+=.1*DiffY),Ymax>50&&(Ymax=50),-50>Ymin&&(Ymin=-50),DiffY=Ymax-Ymin}function Tangentenpunkt(e,t){return t*(e-xalt)+yalt}function col(e){return(e-Xmin)/DiffX*W}function row(e){return(Ymax-e)/DiffY*H}function ergaenze_term(){term=term.replace(/asin\(/g,"hilfa"),term=term.replace(/acos\(/g,"hilfb"),term=term.replace(/atan\(/g,"hilfc"),term=term.replace(/sin\(/g,"Math.sin("),term=term.replace(/cos\(/g,"Math.cos("),term=term.replace(/tan\(/g,"Math.tan("),term=term.replace(/hilfa/g,"Math.asin("),term=term.replace(/hilfb/g,"Math.acos("),term=term.replace(/hilfc/g,"Math.atan("),term=term.replace(/abs\(/g,"Math.abs("),term=term.replace(/pow\(/g,"Math.pow("),term=term.replace(/sqrt\(/g,"Math.sqrt("),term=term.replace(/log\(/g,"Math.log("),term=term.replace(/ln\(/g,"Math.log("),term=term.replace(/exp\(/g,"Math.ixp"),term=term.replace(/e/g,"Math.E"),term=term.replace(/Math.ixp/g,"Math.exp("),term=term.replace(/pi/g,"Math.PI")}function Fehlerbehandlung(){alert("Fehler im Funktionsterm. Bitte korrigieren.")}var W,H,Xmin,Xmax,Ymin,Ymax,ctx,DiffX,DiffY,term,xalt,xneu,yalt,yneu,y1,y2,niters=0,max_iters,epsilon,initmade=!1;window.onload=resizeCanvas;